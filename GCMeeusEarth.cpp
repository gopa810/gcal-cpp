#include "stdafx.h"
#include "GCMeeusEarth.h"


GCMeeusEarth::GCMeeusEarth(void)
{
}


GCMeeusEarth::~GCMeeusEarth(void)
{
}

double GCMeeusEarth::vsop87_ear_r0[][3] = {
	/* 4330    1 */  { 100013988.799, 0.00000000000,      0.00000000000 },
        /* 4330    2 */  {   1670699.626, 3.09846350771,   6283.07584999140 },
        /* 4330    3 */  {     13956.023, 3.05524609620,  12566.15169998280 },
        /* 4330    4 */  {      3083.720, 5.19846674381,  77713.77146812050 },
        /* 4330    5 */  {      1628.461, 1.17387749012,   5753.38488489680 },
        /* 4330    6 */  {      1575.568, 2.84685245825,   7860.41939243920 },
        /* 4330    7 */  {       924.799, 5.45292234084,  11506.76976979360 },
        /* 4330    8 */  {       542.444, 4.56409149777,   3930.20969621960 },
        /* 4330    9 */  {       472.110, 3.66100022149,   5884.92684658320 },
        /* 4330   10 */  {       328.780, 5.89983646482,   5223.69391980220 },
        /* 4330   11 */  {       345.983, 0.96368617687,   5507.55323866740 },
        /* 4330   12 */  {       306.784, 0.29867139512,   5573.14280143310 },
        /* 4330   13 */  {       174.844, 3.01193636534,  18849.22754997420 },
        /* 4330   14 */  {       243.189, 4.27349536153,  11790.62908865880 },
        /* 4330   15 */  {       211.829, 5.84714540314,   1577.34354244780 },
        /* 4330   16 */  {       185.752, 5.02194447178,  10977.07880469900 },
        /* 4330   17 */  {       109.835, 5.05510636285,   5486.77784317500 },
        /* 4330   18 */  {        98.316, 0.88681311277,   6069.77675455340 },
        /* 4330   19 */  {        86.499, 5.68959778254,  15720.83878487840 },
        /* 4330   20 */  {        85.825, 1.27083733351, 161000.68573767410 },
        /* 4330   21 */  {        62.916, 0.92177108832,    529.69096509460 },
        /* 4330   22 */  {        57.056, 2.01374292014,  83996.84731811189 },
        /* 4330   23 */  {        64.903, 0.27250613787,  17260.15465469040 },
        /* 4330   24 */  {        49.384, 3.24501240359,   2544.31441988340 },
        /* 4330   25 */  {        55.736, 5.24159798933,  71430.69561812909 },
        /* 4330   26 */  {        42.515, 6.01110242003,   6275.96230299060 },
        /* 4330   27 */  {        46.963, 2.57805070386,    775.52261132400 },
        /* 4330   28 */  {        38.968, 5.36071738169,   4694.00295470760 },
        /* 4330   29 */  {        44.661, 5.53715807302,   9437.76293488700 },
        /* 4330   30 */  {        35.660, 1.67468058995,  12036.46073488820 },
        /* 4330   31 */  {        31.921, 0.18368229781,   5088.62883976680 },
        /* 4330   32 */  {        31.846, 1.77775642085,    398.14900340820 },
        /* 4330   33 */  {        33.193, 0.24370300098,   7084.89678111520 },
        /* 4330   34 */  {        38.245, 2.39255343974,   8827.39026987480 },
        /* 4330   35 */  {        28.464, 1.21344868176,   6286.59896834040 },
        /* 4330   36 */  {        37.490, 0.82952922332,  19651.04848109800 },
        /* 4330   37 */  {        36.957, 4.90107591914,  12139.55350910680 },
        /* 4330   38 */  {        34.537, 1.84270693282,   2942.46342329160 },
        /* 4330   39 */  {        26.275, 4.58896850401,  10447.38783960440 },
		/* 4330   42 */  {        27.793, 1.89934330904,   6279.55273164240 },
	{         0.000, 0.00000000000,      0.00000000000 }
};

double GCMeeusEarth::vsop87_ear_r1[][3] = {
        /* 4331    1 */  {    103018.608, 1.10748969588,   6283.07584999140 },
        /* 4331    2 */  {      1721.238, 1.06442301418,  12566.15169998280 },
        /* 4331    3 */  {       702.215, 3.14159265359,      0.00000000000 },
        /* 4331    4 */  {        32.346, 1.02169059149,  18849.22754997420 },
        /* 4331    5 */  {        30.799, 2.84353804832,   5507.55323866740 },
        /* 4331    6 */  {        24.971, 1.31906709482,   5223.69391980220 },
        /* 4331    7 */  {        18.485, 1.42429748614,   1577.34354244780 },
        /* 4331    8 */  {        10.078, 5.91378194648,  10977.07880469900 },
        /* 4331    9 */  {         8.634, 0.27146150602,   5486.77784317500 },
		/* 4331   10 */  {         8.654, 1.42046854427,   6275.96230299060 },
	{         0.000, 0.00000000000,      0.00000000000 }
};

double GCMeeusEarth::vsop87_ear_r2[][3] = {
        /* 4332    1 */  {      4359.385, 5.78455133738,   6283.07584999140 },
        /* 4332    2 */  {       123.633, 5.57934722157,  12566.15169998280 },
        /* 4332    3 */  {        12.341, 3.14159265359,      0.00000000000 },
        /* 4332    4 */  {         8.792, 3.62777733395,  77713.77146812050 },
        /* 4332    5 */  {         5.689, 1.86958905084,   5573.14280143310 },
		/* 4332    6 */  {         3.301, 5.47027913302,  18849.22754997420 },
	{         0.000, 0.00000000000,      0.00000000000 }
};

double GCMeeusEarth::vsop87_ear_r3[][3] = {
        /* 4333    1 */  {       144.595, 4.27319435148,   6283.07584999140 },
		/* 4333    2 */  {         6.729, 3.91697608662,  12566.15169998280 },
	{         0.000, 0.00000000000,      0.00000000000 }

};

double GCMeeusEarth::vsop87_ear_r4[][3] = {
	/* 4334    1 */  {         3.858, 2.56384387339,   6283.07584999140 },
	{         0.000, 0.00000000000,      0.00000000000 }
};

double GCMeeusEarth::vsop87_ear_r5[][3] = {
	{         0.000, 0.00000000000,      0.00000000000 }
};

double GCMeeusEarth::vsop87_ear_b0[][3] = {
        /* 4320    1 */  {       279.620, 3.19870156017,  84334.66158130829 },
        /* 4320    2 */  {       101.643, 5.42248619256,   5507.55323866740 },
        /* 4320    3 */  {        80.445, 3.88013204458,   5223.69391980220 },
        /* 4320    4 */  {        43.806, 3.70444689758,   2352.86615377180 },
		/* 4320    5 */  {        31.933, 4.00026369781,   1577.34354244780 },
	{         0.000, 0.00000000000,      0.00000000000 },
};

double GCMeeusEarth::vsop87_ear_b1[][3] = {
            /* 4321    1 */  {         9.030, 3.89729061890,   5507.55323866740 },
			/* 4321    2 */  {         6.177, 1.73038850355,   5223.69391980220 },
	{         0.000, 0.00000000000,      0.00000000000 },
};
double GCMeeusEarth::vsop87_ear_b2[][3] = {
	{         0.000, 0.00000000000,      0.00000000000 },
};
double GCMeeusEarth::vsop87_ear_b3[][3] = {
	{         0.000, 0.00000000000,      0.00000000000 },
};
double GCMeeusEarth::vsop87_ear_b4[][3] = {
	{         0.000, 0.00000000000,      0.00000000000 },
};
double GCMeeusEarth::vsop87_ear_b5[][3] = {
	{         0.000, 0.00000000000,      0.00000000000 },
};

double GCMeeusEarth::vsop87_ear_l0[][3] = {
            /* 4310    1 */  { 175347045.673, 0.00000000000,      0.00000000000 },
            /* 4310    2 */  {   3341656.456, 4.66925680417,   6283.07584999140 },
            /* 4310    3 */  {     34894.275, 4.62610241759,  12566.15169998280 },
            /* 4310    4 */  {      3417.571, 2.82886579606,      3.52311834900 },
            /* 4310    5 */  {      3497.056, 2.74411800971,   5753.38488489680 },
            /* 4310    6 */  {      3135.896, 3.62767041758,  77713.77146812050 },
            /* 4310    7 */  {      2676.218, 4.41808351397,   7860.41939243920 },
            /* 4310    8 */  {      2342.687, 6.13516237631,   3930.20969621960 },
            /* 4310    9 */  {      1273.166, 2.03709655772,    529.69096509460 },
            /* 4310   10 */  {      1324.292, 0.74246356352,  11506.76976979360 },
            /* 4310   11 */  {       901.855, 2.04505443513,     26.29831979980 },
            /* 4310   12 */  {      1199.167, 1.10962944315,   1577.34354244780 },
            /* 4310   13 */  {       857.223, 3.50849156957,    398.14900340820 },
            /* 4310   14 */  {       779.786, 1.17882652114,   5223.69391980220 },
            /* 4310   15 */  {       990.250, 5.23268129594,   5884.92684658320 },
            /* 4310   16 */  {       753.141, 2.53339053818,   5507.55323866740 },
            /* 4310   17 */  {       505.264, 4.58292563052,  18849.22754997420 },
            /* 4310   18 */  {       492.379, 4.20506639861,    775.52261132400 },
            /* 4310   19 */  {       356.655, 2.91954116867,      0.06731030280 },
            /* 4310   20 */  {       284.125, 1.89869034186,    796.29800681640 },
            /* 4310   21 */  {       242.810, 0.34481140906,   5486.77784317500 },
            /* 4310   22 */  {       317.087, 5.84901952218,  11790.62908865880 },
            /* 4310   23 */  {       271.039, 0.31488607649,  10977.07880469900 },
            /* 4310   24 */  {       206.160, 4.80646606059,   2544.31441988340 },
            /* 4310   25 */  {       205.385, 1.86947813692,   5573.14280143310 },
            /* 4310   26 */  {       202.261, 2.45767795458,   6069.77675455340 },
            /* 4310   27 */  {       126.184, 1.08302630210,     20.77539549240 },
            /* 4310   28 */  {       155.516, 0.83306073807,    213.29909543800 },
            /* 4310   29 */  {       115.132, 0.64544911683,      0.98032106820 },
            /* 4310   30 */  {       102.851, 0.63599846727,   4694.00295470760 },
            /* 4310   31 */  {       101.724, 4.26679821365,      7.11354700080 },
            /* 4310   32 */  {        99.206, 6.20992940258,   2146.16541647520 },
            /* 4310   33 */  {       132.212, 3.41118275555,   2942.46342329160 },
            /* 4310   34 */  {        97.607, 0.68101272270,    155.42039943420 },
            /* 4310   35 */  {        85.128, 1.29870743025,   6275.96230299060 },
            /* 4310   36 */  {        74.651, 1.75508916159,   5088.62883976680 },
            /* 4310   37 */  {       101.895, 0.97569221824,  15720.83878487840 },
            /* 4310   38 */  {        84.711, 3.67080093025,  71430.69561812909 },
            /* 4310   39 */  {        73.547, 4.67926565481,    801.82093112380 },
            /* 4310   40 */  {        73.874, 3.50319443167,   3154.68708489560 },
            /* 4310   41 */  {        78.756, 3.03698313141,  12036.46073488820 },
            /* 4310   42 */  {        79.637, 1.80791330700,  17260.15465469040 },
            /* 4310   43 */  {        85.803, 5.98322631256, 161000.68573767410 },
            /* 4310   44 */  {        56.963, 2.78430398043,   6286.59896834040 },
            /* 4310   45 */  {        61.148, 1.81839811024,   7084.89678111520 },
            /* 4310   46 */  {        69.627, 0.83297596966,   9437.76293488700 },
            /* 4310   47 */  {        56.116, 4.38694880779,  14143.49524243060 },
            /* 4310   48 */  {        62.449, 3.97763880587,   8827.39026987480 },
            /* 4310   49 */  {        51.145, 0.28306864501,   5856.47765911540 },
            /* 4310   50 */  {        55.577, 3.47006009062,   6279.55273164240 },
            /* 4310   51 */  {        41.036, 5.36817351402,   8429.24126646660 },
            /* 4310   52 */  {        51.605, 1.33282746983,   1748.01641306700 },
            /* 4310   53 */  {        51.992, 0.18914945834,  12139.55350910680 },
            /* 4310   54 */  {        49.000, 0.48735065033,   1194.44701022460 },
            /* 4310   55 */  {        39.200, 6.16832995016,  10447.38783960440 },
            /* 4310   56 */  {        35.566, 1.77597314691,   6812.76681508600 },
            /* 4310   57 */  {        36.770, 6.04133859347,  10213.28554621100 },
            /* 4310   58 */  {        36.596, 2.56955238628,   1059.38193018920 },
            /* 4310   59 */  {        33.291, 0.59309499459,  17789.84561978500 },
            /* 4310   60 */  {        35.954, 1.70876111898,   2352.86615377180 },
            /* 4310   61 */  {        40.938, 2.39850881707,  19651.04848109800 },
            /* 4310   62 */  {        30.047, 2.73975123935,   1349.86740965880 },
            /* 4310   63 */  {        30.412, 0.44294464135,  83996.84731811189 },
			/* 4310   68 */  {        25.352, 3.16470953405,   4690.47983635860 },
	{         0.000, 0.00000000000,      0.00000000000 },
};
double GCMeeusEarth::vsop87_ear_l1[][3] = {
            /* 4311    1 */{628331966747.491, 0.00000000000,      0.00000000000 },
            /* 4311    2 */  {    206058.863, 2.67823455584,   6283.07584999140 },
            /* 4311    3 */  {      4303.430, 2.63512650414,  12566.15169998280 },
            /* 4311    4 */  {       425.264, 1.59046980729,      3.52311834900 },
            /* 4311    5 */  {       108.977, 2.96618001993,   1577.34354244780 },
            /* 4311    6 */  {       093.478, 2.59212835365,  18849.22754997420 },
            /* 4311    7 */  {       119.261, 5.79557487799,     26.29831979980 },
            /* 4311    8 */  {        72.122, 1.13846158196,    529.69096509460 },
            /* 4311    9 */  {        67.768, 1.87472304791,    398.14900340820 },
            /* 4311   10 */  {        67.327, 4.40918235168,   5507.55323866740 },
            /* 4311   11 */  {        59.027, 2.88797038460,   5223.69391980220 },
            /* 4311   12 */  {        55.976, 2.17471680261,    155.42039943420 },
            /* 4311   13 */  {        45.407, 0.39803079805,    796.29800681640 },
            /* 4311   14 */  {        36.369, 0.46624739835,    775.52261132400 },
            /* 4311   15 */  {        28.958, 2.64707383882,      7.11354700080 },
            /* 4311   16 */  {        19.097, 1.84628332577,   5486.77784317500 },
            /* 4311   17 */  {        20.844, 5.34138275149,      0.98032106820 },
            /* 4311   18 */  {        18.508, 4.96855124577,    213.29909543800 },
            /* 4311   19 */  {        16.233, 0.03216483047,   2544.31441988340 },
            /* 4311   20 */  {        17.293, 2.99116864949,   6275.96230299060 },
            /* 4311   21 */  {        15.832, 1.43049285325,   2146.16541647520 },
            /* 4311   22 */  {        14.615, 1.20532366323,  10977.07880469900 },
            /* 4311   23 */  {        11.877, 3.25804815607,   5088.62883976680 },
            /* 4311   24 */  {        11.514, 2.07502418155,   4694.00295470760 },
            /* 4311   25 */  {         9.721, 4.23925472239,   1349.86740965880 },
            /* 4311   26 */  {         9.969, 1.30262991097,   6286.59896834040 },
            /* 4311   27 */  {         9.452, 2.69957062864,    242.72860397400 },
            /* 4311   28 */  {        12.461, 2.83432285512,   1748.01641306700 },
            /* 4311   29 */  {        11.808, 5.27379790480,   1194.44701022460 },
            /* 4311   30 */  {         8.577, 5.64475868067,    951.71840625060 },
            /* 4311   31 */  {        10.641, 0.76614199202,    553.56940284240 },
            /* 4311   32 */  {         7.576, 5.30062664886,   2352.86615377180 },
            /* 4311   34 */  {         6.385, 2.65033984967,   9437.76293488700 },
			/* 4311   37 */  {         6.101, 4.66632584188,   4690.47983635860 },
	{         0.000, 0.00000000000,      0.00000000000 },
    };
double GCMeeusEarth::vsop87_ear_l2[][3] = {
            /* 4312    1 */  {     52918.870, 0.00000000000,      0.00000000000 },
            /* 4312    2 */  {      8719.837, 1.07209665242,   6283.07584999140 },
            /* 4312    3 */  {       309.125, 0.86728818832,  12566.15169998280 },
            /* 4312    4 */  {        27.339, 0.05297871691,      3.52311834900 },
            /* 4312    5 */  {        16.334, 5.18826691036,     26.29831979980 },
            /* 4312    6 */  {        15.752, 3.68457889430,    155.42039943420 },
            /* 4312    7 */  {         9.541, 0.75742297675,  18849.22754997420 },
            /* 4312    8 */  {         8.937, 2.05705419118,  77713.77146812050 },
            /* 4312    9 */  {         6.952, 0.82673305410,    775.52261132400 },
            /* 4312   10 */  {         5.064, 4.66284525271,   1577.34354244780 },
            /* 4312   11 */  {         4.061, 1.03057162962,      7.11354700080 },
            /* 4312   12 */  {         3.463, 5.14074632811,    796.29800681640 },
            /* 4312   13 */  {         3.169, 6.05291851171,   5507.55323866740 },
            /* 4312   14 */  {         3.020, 1.19246506441,    242.72860397400 },
            /* 4312   15 */  {         2.886, 6.11652627155,    529.69096509460 },
            /* 4312   16 */  {         3.810, 3.44050803490,   5573.14280143310 },
            /* 4312   17 */  {         2.714, 0.30637881025,    398.14900340820 },
            /* 4312   18 */  {         2.371, 4.38118838167,   5223.69391980220 },
            /* 4312   19 */  {         2.538, 2.27992810679,    553.56940284240 },
			/* 4312   20 */  {         2.079, 3.75435330484,      0.98032106820 },
	{         0.000, 0.00000000000,      0.00000000000 },
};
double GCMeeusEarth::vsop87_ear_l3[][3] = {
            /* 4313    1 */  {       289.226, 5.84384198723,   6283.07584999140 },
            /* 4313    2 */  {        34.955, 0.00000000000,      0.00000000000 },
            /* 4313    3 */  {        16.819, 5.48766912348,  12566.15169998280 },
            /* 4313    4 */  {         2.962, 5.19577265202,    155.42039943420 },
            /* 4313    5 */  {         1.288, 4.72200252235,      3.52311834900 },
            /* 4313    6 */  {         0.635, 5.96925937141,    242.72860397400 },
			/* 4313    7 */  {         0.714, 5.30045809128,  18849.22754997420 },
	{         0.000, 0.00000000000,      0.00000000000 },
};
double GCMeeusEarth::vsop87_ear_l4[][3] = {
            /* 4314    1 */  {       114.084, 3.14159265359,      0.00000000000 },
            /* 4314    2 */  {         7.717, 4.13446589358,   6283.07584999140 },
			/* 4314    3 */  {         0.765, 3.83803776214,  12566.15169998280 },
	{         0.000, 0.00000000000,      0.00000000000 },
};

double GCMeeusEarth::vsop87_ear_l5[][3] = {
	/* 4315    1 */  {         0.878, 3.14159265359,      0.00000000000 },
	{         0.000, 0.00000000000,      0.00000000000 },
};

double GCMeeusEarth::latitudeFactorCount(int nr)
{
	if (nr == 0)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_b0[i][0] < 0.01) return i;
		}
	if (nr == 1)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_b1[i][0] < 0.01) return i;
		}
	if (nr == 2)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_b2[i][0] < 0.01) return i;
		}
	if (nr == 3)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_b3[i][0] < 0.01) return i;
		}
	if (nr == 4)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_b4[i][0] < 0.01) return i;
		}
	if (nr == 5)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_b5[i][0] < 0.01) return i;
		}
	return 0;
}

double * GCMeeusEarth::latitudeFactor(int nr, int index)
{
	if (nr == 0)
		return vsop87_ear_b0[index];
	if (nr == 1)
		return vsop87_ear_b1[index];
	if (nr == 2)
		return vsop87_ear_b2[index];
	if (nr == 3)
		return vsop87_ear_b3[index];
	if (nr == 4)
		return vsop87_ear_b4[index];
	if (nr == 5)
		return vsop87_ear_b5[index];
}

double GCMeeusEarth::longitudeFactorCount(int nr)
{
	if (nr == 0)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_l0[i][0] < 0.01) return i;
		}
	if (nr == 1)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_l1[i][0] < 0.01) return i;
		}
	if (nr == 2)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_l2[i][0] < 0.01) return i;
		}
	if (nr == 3)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_l3[i][0] < 0.01) return i;
		}
	if (nr == 4)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_l4[i][0] < 0.01) return i;
		}
	if (nr == 5)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_l5[i][0] < 0.01) return i;
		}
	return 0;
}

double * GCMeeusEarth::longitudeFactor(int nr, int index)
{
	if (nr == 0)
		return vsop87_ear_l0[index];
	if (nr == 1)
		return vsop87_ear_l1[index];
	if (nr == 2)
		return vsop87_ear_l2[index];
	if (nr == 3)
		return vsop87_ear_l3[index];
	if (nr == 4)
		return vsop87_ear_l4[index];
	if (nr == 5)
		return vsop87_ear_l5[index];
}

double GCMeeusEarth::radiusFactorCount(int nr)
{
	if (nr == 0)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_r0[i][0] < 0.01) return i;
		}
	if (nr == 1)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_r1[i][0] < 0.01) return i;
		}
	if (nr == 2)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_r2[i][0] < 0.01) return i;
		}
	if (nr == 3)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_r3[i][0] < 0.01) return i;
		}
	if (nr == 4)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_r4[i][0] < 0.01) return i;
		}
	if (nr == 5)
		for(int i = 0; i < 10000; i++)
		{
			if (vsop87_ear_r5[i][0] < 0.01) return i;
		}

	return 0;
}

double * GCMeeusEarth::radiusFactor(int nr, int index)
{
	if (nr == 0)
		return vsop87_ear_r0[index];
	if (nr == 1)
		return vsop87_ear_r1[index];
	if (nr == 2)
		return vsop87_ear_r2[index];
	if (nr == 3)
		return vsop87_ear_r3[index];
	if (nr == 4)
		return vsop87_ear_r4[index];
	if (nr == 5)
		return vsop87_ear_r5[index];
}

